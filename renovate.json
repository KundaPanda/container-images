{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:recommended"],
  "timezone": "UTC",

  "packageRules": [
    {
      "matchCategories": ["docker"],
      "enabled": true,
      "pinDigests": false,
      "automerge": true,
      "automergeType": "branch",
      "ignoreTests": true
    }
  ],

  "customManagers": [
    {
      "customType": "regex",
      "description": "Update *_VERSION args in Dockerfiles based on # renovate: comments on previous line (quoted or unquoted)",
      "fileMatch": [
        "(^|/|\\.)Dockerfile$",
        "(^|/)Dockerfile\\.[^/]*$"
      ],
      "matchStrings": [
        "#\\s*renovate:\\s*datasource=(?<datasource>\\S+)\\s+depName=(?<depName>\\S+)(?:\\s+versioning=\"?(?<versioning>[^\"]+)\"?)?\\s*(?:\\s+extractVersion=\"?(?<extractVersion>[^\"]+)\"?)?\\s*\\nARG\\s+(?<argName>[A-Za-z_][A-Za-z0-9_]*)\\s*=\\s*\"?((?<currentValue>[^\"\\s]+))\"?"
      ],
      "depNameTemplate": "{{{ depName }}}@{{{ argName }}}",
      "lookupNameTemplate": "{{{ depName }}}",
      "versioningTemplate": "{{#if versioning}}{{{versioning}}}{{else}}semver{{/if}}",
      "extractVersionTemplate": "{{#if extractVersion}}{{{extractVersion}}}{{/if}}"
    }
  ]
}
